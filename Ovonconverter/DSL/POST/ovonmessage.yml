input_step:
  assign:
    input: ${incoming.body.input}
    type: ${incoming.body.type}

validate_step:
  switch:
    - condition: ${type === "ovon"}
      next: translate_step
    - condition: ${type === "json"}
      next: json_step
  next: pass_step

translate_step:
  call: http.post
  args:
    url: http://ovon_dmapper:3000/hbs/ovonconvert
    body: 
      inputvalue: ${input}
    headers:
      type: 'pass'
  result: convertedMessage

translate_back_step:
  call: http.post
  args:
    url: http://ovon_dmapper:3000/js/ovon-to-buerokratt
    body: 
      inputvalue: ${convertedMessage.response.body}
  result: buerokrattMessage      

return_step:
  return: ${buerokrattMessage}
  next: end

json_step:
  return: ${incoming.body}
  next: end

pass_step:
  return: ${input}
  next: end